<!--
 ~ Copyright 2022 youngmonkeys.org
 ~ 
 ~ Licensed under the ezyplatform, Version 1.0.0 (the "License");
 ~ you may not use this file except in compliance with the License.
 ~ You may obtain a copy of the License at
 ~ 
 ~     https://youngmonkeys.org/licenses/ezyplatform-1.0.0.txt
 ~ 
 ~ Unless required by applicable law or agreed to in writing, software
 ~ distributed under the License is distributed on an "AS IS" BASIS,
 ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 ~ See the License for the specific language governing permissions and
 ~ limitations under the License.
-->

<!DOCTYPE html>
<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:th="http://www.thymeleaf.org">
<body>
<script th:fragment="change">
ecommerce.onCountryChange = function(e) {
    var countryId = $(e).val();
    ecommerce.changeProvincesByCountryId(countryId);
}

ecommerce.changeProvincesByCountryId = function(countryId) {
    $.ajax({
        type: "GET",
        url: '/ecommerce/api/v1/countries/' +
            countryId +
            '/provinces',
        success: function(provinces) {
            var html = '';
            provinces.forEach((province) => {
                html += `<option value="${province.id}">${province.displayName}</option>`;
            });
            $(`#${ecommerce.provincesSelectId}`)
                .html(html)
                .trigger('change');
        },
        error: function(data, e) {
            ezyadmin.processGetApiErrors(data);
        }
    });
}

ecommerce.onProvinceChange = function(e) {
    var provinceId = $(e).val();
    ecommerce.changeDistrictsByProvinceId(provinceId);
}

ecommerce.changeDistrictsByProvinceId = function(provinceId) {
    if (!provinceId) {
        $(`#${ecommerce.districtsSelectId}`).html('');
        return;
    }
    $.ajax({
        type: "GET",
        url: '/ecommerce/api/v1/provinces/' +
            provinceId +
            '/districts',
        success: function(districts) {
            var html = '';
            districts.forEach((district) => {
                html += `<option value="${district.id}">${district.displayName}</option>`;
            });
            $(`#${ecommerce.districtsSelectId}`)
                .html(html)
                .trigger('change');
        },
        error: function(data, e) {
            ezyadmin.processGetApiErrors(data);
        }
    });
}

ecommerce.onDistrictChange = function(e) {
    var districtId = $(e).val();
    ecommerce.changeWardsByDistrictId(districtId);
}

ecommerce.changeWardsByDistrictId = function(districtId) {
    if (!districtId) {
        $(`#${ecommerce.wardsSelectId}`).html('');
        return;
    }
    $.ajax({
        type: "GET",
        url: '/ecommerce/api/v1/districts/' +
            districtId +
            '/wards',
        success: function(wards) {
            var html = '';
            wards.forEach((ward) => {
                html += `<option value="${ward.id}">${ward.displayName}</option>`;
            });
            $(`#${ecommerce.wardsSelectId}`)
                .html(html)
                .trigger('change');
        },
        error: function(data, e) {
            ezyadmin.processGetApiErrors(data);
        }
    });
}
</script>
</body>
</html>
